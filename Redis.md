

[TOC]

### Redis：

##### 传统RDBMS和NoSQL区别

> 传统的RDBMS

- 结构化组织
- SQL
- 数据和关系都存在单独的表中
- 数据操作，数据定义语言
- 严格的一致性
- 基础的事务

> NoSQL

- 不仅仅是数据
- 没有固定的查询语言
- 简直对存储，列存储，文档存储，图形数据库（社交关系）
- 最终一致性
- CAP定理和BASE（异地多活）
- 高性能，高可用，高可扩

##### NoSQL的四大分类

1、**KV 键值对**

2、**文档型数据库**

- MongoDB：是一种基于分布式文件存储的数据库，C++编写，主要用来处理大量的文档！
- MongoDB是一种介于关系型数据库和非关系型数据库中间的产品，MongoDB是非关系型数据库中功能最丰富，最像关系型数据库的。

3、**列存储数据库**

- HBASE
- 分布式文件系统

4、**图关系数据库**

##### 主从模式

1. 主从复制特点：

   1. 主数据库可以进行读写操作，当读写操作导致数据变化时会自动将数据同步给从数据库
   2. 从数据库一般都是只读的，并且接收主数据库同步过来的数据
   3. 一个master可以拥有多个slave，但是一个slave只能对应一个master
   4. slave挂了不影响其他slave的读和master的读和写，重新启动后会将数据从master同步过来
   5. master挂了以后，不影响slave的读，但redis不再提供写服务，master重启后redis将重新对外提供写服务
   6. master挂了以后，不会在slave节点中重新选一个master

2. 工作机制：

   









##### Sentinel模式

1. redis分布式锁的实现？

   先拿setnx来争抢锁，抢到之后，再用expire给锁加一个过期时间防止锁忘记释放

2. 如果在setnx之后执行expire之前进程意外crash或者要重启维护了，会怎么样？

   set指令有非常复杂的参数，这个应该是可以同时把setnx和expire合成一条指令来用的

3. redis做异步队列，怎么用？有什么缺点？

   一般使用list结构作为队列，rpush生产消息，lpop没有消息的时候，要适当sleep一会再重试。

   缺点：在消费者下线的情况下，生产的消息会丢失，得使用专业的消息队列如rabbitmq等。

   **能不能生产一次消费多次呢？**

   使用pub/sub主题订阅者模式，可以实现1：N的消息队列。

4. 



##### Cluster模式